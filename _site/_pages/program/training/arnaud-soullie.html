<p>On this intense 2-days training, you will learn everything you need to start pentesting Industrial Control Networks. We will cover the basics to help you understand what are the most common ICS vulnerabilities.</p>

<p>We will then spend some time learning and exploiting Windows &amp; Active Directory weaknesses, as most ICS are controlled by Windows systems. We will cover the most common ICS protocols (Modbus, S7, Profinet, Ethernet/IP, DNP3, OPC…), analyze packet captures and learn how to use these protocols to talk to Programmable Logic Controllers (PLCs).</p>

<p>You will learn how to program a PLC, to better understand how to exploit them. The training will end with an afternoon dedicated to a challenging hands-on exercise: The first CTF in which you capture a real flag! Using your newly acquired skills, you will try to compromise a Windows Active Directory, pivot to an ICS setup to take control of a model train and robotic arms.</p>

<h4 id="the-detailed-outline-of-the-training-will-be-the-following">The detailed outline of the training will be the following:</h4>

<ul>
  <li>Introduction to ICS &amp; common vulnerabilities</li>
  <li>Pentesting Basics &amp; tools [Hands-on]</li>
  <li>Windows basics and pentesting Windows [Hands-on]</li>
  <li>Focus on ICS protocols</li>
  <li>Programming PLCs [Hands-on]</li>
  <li>Pentesting ICS [Hands-on]</li>
  <li>Capture The Flag [Hands-on]</li>
</ul>

<h3 id="detailed-content">Detailed content</h3>

<h4 id="module-1-introduction-to-ics--common-vulnerabilities">Module 1: Introduction to ICS &amp; common vulnerabilities</h4>

<p>For starters, I will introduce the concept of ICS.</p>

<p>The topics will include:</p>
<ul>
  <li>Vocabulary</li>
  <li>Classic architectures</li>
  <li>ICS components (PLCs, HMI, SCADA, DCS, sensors, RTUs, Historian, etc) and their roles</li>
  <li>OT vs IT</li>
</ul>

<p>I will also introduce attendees to the most common vulnerabilities in ICS, and describes some of the public attacks:</p>
<ul>
  <li>Lack of network segmentation / Exposure</li>
  <li>Lack of hardening - ICS protocols insecurity</li>
</ul>

<p><em>This module is not hands-on</em></p>

<h4 id="module-2-pentesting-basics--tools">Module 2: Pentesting Basics &amp; tools</h4>

<p>This module will introduce the concept of penetration test.
I do not intend to spend too much time of the theoretical stuff (how to make
a report, etc etc) since that is not what attendees are looking for.</p>

<p>However, I think a module is required to ensure that everyone shares at least the
basic concepts of penetration testing, in order to understand the rest of the training.
The module will include :</p>
<ul>
  <li>OSINT for ICS : Where to look to find informations</li>
  <li>Reconnaissance : how to portscan &amp; nessus</li>
  <li>Exploitation : Metasploit basics</li>
</ul>

<p>Toolz used : nmap, Nessus, Metasploit</p>

<p>Lab setup : Windows Servers and workstations, Metasploitable, Kali Linux</p>

<h4 id="module-3-windows-basics-and-pentesting-windows">Module 3: Windows basics and pentesting Windows</h4>
<p>Any ICS now includes, at least in some areas, Windows systems. So I think that some time must be spent on Windows basics.</p>

<p>This module will introduce the following topics:</p>
<ul>
  <li>Windows Active Directory</li>
  <li>How to find credentials on Windows systems</li>
  <li>Exploiting and pivoting to gain Domain Admin privileges</li>
</ul>

<p>A selection of hacking techniques will be applied on lab machines.</p>

<h4 id="module-4-focus-on-ics-protocols">Module 4: Focus on ICS protocols</h4>

<p>This module will introduce the most common ICS protocols: Modbus/TCP, S7, Profinet, DNP3, Ethernet/IP…. Attendees will analyze network captures and be introduced to software libraries/ clients to use these protocols to talk to PLC simulators.</p>

<p><em>This module is not hands-on</em></p>

<h4 id="module-5-programming-plcs">Module 5: Programming PLCs</h4>
<p>In order to have a better understanding of how a PLC works, student will use dedicated software to program a PLC in ladder logic (using trial versions of TIA portal and/or soMachine basic).</p>

<p>Students will then deploy the code to real PLCs.</p>

<p>Toolz used : SoMachine Basic</p>

<p>Lab : Windows virtual machine</p>

<h4 id="module-6-pentesting-ics">Module 6: Pentesting ICS</h4>
<p>This module will be mostly lab sessions, in order to apply the knowledge learned so far:</p>
<ul>
  <li>Network capture analysis &amp; replaying packets</li>
  <li>Talking industrial protocols: Modbus, S7</li>
  <li>Additional PLC features: web server, ftp, snmp and how to exploit it</li>
</ul>

<p>Toolz used : nmap, Nessus, Metasploit</p>

<p>Lab : Windows Servers and workstations, Kali Linux, Siemens and Schneider PLCs</p>

<h4 id="module-7-capture-the-flag">Module 7: Capture The Flag</h4>

<p>I strongly believe that a good training must include “real-life” examples and labs. I will dedicate the last half-day of the training to a Capture The Flag event. To do so, I will have a specific setup where attendees will be able to use their newly-acquired knowledge on a simulation of a “real-life” system. This will include compromise of Windows host, pivoting to the ICS, understanding the industrial process, and finally capturing a real flag with a robot hand!</p>

<p>This will be an expanded version of the CTF I usually organize during the ICS workshops at conferences.</p>

<h4 id="target-audience">Target audience</h4>
<p>This training is aimed at OT professionals willing to understand what are the security issues within ICS, and how
to technically assess the security level of an ICS. It will also be beneficial for IT security professionals wanting to understand the technical specificities of ICS.</p>

<h4 id="key-takeaways">Key takeaways</h4>
<p>The attendees will learn what are the common ICS vulnerabilities, the tools and techniques to assess an ICS (both Windows systems and PLCs), and will practice these techniques during an hands-on Capture The Flag on real hardware.</p>

<h4 id="training-preparations">Training Preparations</h4>
<p>Laptop Required</p>

<p>Attendees will need to bring a laptop that fits the following specs:</p>

<ul>
  <li>A PC with VirtualBox capable of running virtual machines.</li>
  <li>At least 4GB RAM</li>
  <li>At least 40 GB free disk space</li>
  <li>VirtualBox (64 bit) installed (VMWare could be used but will not be supported in the training)</li>
</ul>

<p>Several VirtualBox VMs will be provided on USB flash drives at the beginning of the training.</p>

<p>Please note that having a 64-bit CPU and a 64-bit OS is not always enough to support 64-bit virtualization. You might need to enable features such as ”AMD-V”, ”VT-x” or ”Hyper-V” in BIOS in order to run virtual machines in 64-bit mode.</p>

<p>Please try to run a 64-bit VM prior to the training.</p>
